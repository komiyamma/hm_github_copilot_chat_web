# このプロジェクトが抱える問題点

このプロジェクトは、秀丸エディタからGitHub Copilot Chatを便利に利用するためのツールですが、その実装方法に起因するいくつかの問題を抱えています。

## 1. 重大な問題: クリップボードのデータが失われる危険性

本ツールの根幹であるクリップボードの操作に、データ消失のリスクが存在します。

- **不安定な復元処理:** ユーザーが元々クリップボードに保持していた内容を一時的に保存し、処理後に復元する設計になっています。しかし、この復元処理は、複数の `setTimeout` (遅延実行) を経て呼び出されるため、処理の途中でユーザーが別の操作を行ったり、何らかのエラーで処理が中断されたりすると、**復元処理が実行されず、クリップボードの内容がCopilotへの質問で上書きされたままになります。**
- **外部プログラムへの依存:** クリップボードの復元処理は、`ClipboardHistMngr.exe` という外部プログラムに依存しています。このプログラムが存在しない、または正常に動作しない場合も、クリップボードの復元は失敗します。
- **エラーの隠蔽:** クリップボードの保存・復元処理でエラーが発生しても、`try-catch`ブロックでエラーが無視されるため、問題が起きてもユーザーはそれに気づくことができません。

## 2. 重大な問題: UIオートメーションの脆弱性

本ツールは、ブラウザのUIをキーボード入力のシミュレーション（`Ctrl+V`や`Enter`キーの送信）によって操作しています。この方式は非常に脆弱です。

- **Webサイトの変更への追従不可:** GitHub Copilot ChatのWebサイトのHTML構造やショートカットキーが少しでも変更されると、本ツールは即座に動作しなくなります。
- **複雑な依存関係:** 処理を成立させるために、フォーカス制御用の `HmFocusEachBrowserInputField.exe` や、前述の `ClipboardHistMngr.exe` といった複数の外部プログラムに依存しています。これによりシステム全体が複雑化し、問題が発生した際の切り分けが困難になっています。

## 3. 中程度の問題: 不十分なエラーハンドリング

C#のコードとJavaScriptのコードの両方で、エラーを意図的に無視する `try-catch` ブロックが多用されています。

- これにより、処理が失敗してもユーザーに何のエラーも通知されません。
- ツールが「何もしていないように見える」状態に陥り、ユーザーはなぜ動作しないのかを自力で突き止めることが困難です。

## 4. 軽微な問題: ハードコードされた待機時間

処理の各所で `setTimeout` や `Task.Delay` といった固定時間の待機処理が使われています。

- これは、PCの性能が低い場合や、他の高負荷な処理が同時に実行されている場合に、待機時間が足りずに処理が失敗する原因となります。
- より安定した、完了を待つ仕組み（イベントやコールバックなど）が望まれます。
